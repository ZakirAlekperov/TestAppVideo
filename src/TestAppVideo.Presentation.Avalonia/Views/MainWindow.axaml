<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:TestAppVideo.Presentation.Avalonia.ViewModels"
        x:Class="TestAppVideo.Presentation.Avalonia.Views.MainWindow"
        Width="1000" Height="720"
        Title="Видеоредактор - Разделение видео"
        Background="#FAFAFA">

  <Design.DataContext>
    <vm:MainWindowViewModel />
  </Design.DataContext>

  <TabControl>
    <!-- Вкладка обработки видео -->
    <TabItem>
      <TabItem.Header>
        <TextBlock Text="Обработка видео" FontSize="14" FontWeight="SemiBold" />
      </TabItem.Header>
      
      <Grid RowDefinitions="Auto,Auto,*" Margin="24">
        <Grid.Styles>
          <Style Selector="Grid > :is(Control)">
            <Setter Property="Margin" Value="0,0,0,16" />
          </Style>
        </Grid.Styles>
        
        <!-- Заголовок -->
        <StackPanel Grid.Row="0">
          <TextBlock FontSize="32" FontWeight="Bold" Foreground="#1976D2" Text="Разделение видео" />
          <TextBlock FontSize="14" Foreground="#757575" Text="Быстрое и удобное разделение видеофайлов на равные части" />
        </StackPanel>

        <!-- Настройки -->
        <Border Grid.Row="1" Background="White" CornerRadius="12" BoxShadow="0 2 8 0 #20000000" Padding="24">
          <StackPanel Spacing="20">
            <!-- Выбор видеофайла -->
            <StackPanel Spacing="8">
              <TextBlock Text="Видеофайл" FontSize="14" FontWeight="SemiBold" Foreground="#424242" />
              <Grid ColumnDefinitions="*,Auto">
                <TextBox Grid.Column="0" Text="{Binding InputFilePath}" 
                         Watermark="Выберите видеофайл..."
                         IsReadOnly="True"
                         Margin="0,0,12,0" />
                <Button Grid.Column="1" Content="Обзор" 
                        Command="{Binding BrowseInputFileCommand}"
                        Padding="20,10"
                        Background="#1976D2"
                        Foreground="White"
                        FontWeight="SemiBold"
                        CornerRadius="6" />
              </Grid>
            </StackPanel>

            <!-- Выбор папки -->
            <StackPanel Spacing="8">
              <TextBlock Text="Папка для сохранения" FontSize="14" FontWeight="SemiBold" Foreground="#424242" />
              <Grid ColumnDefinitions="*,Auto">
                <TextBox Grid.Column="0" Text="{Binding OutputDirectory}" 
                         Watermark="Выберите папку..."
                         IsReadOnly="True"
                         Margin="0,0,12,0" />
                <Button Grid.Column="1" Content="Обзор" 
                        Command="{Binding BrowseOutputFolderCommand}"
                        Padding="20,10"
                        Background="#1976D2"
                        Foreground="White"
                        FontWeight="SemiBold"
                        CornerRadius="6" />
              </Grid>
            </StackPanel>

            <!-- Настройки разделения -->
            <Grid ColumnDefinitions="*,*">
              <Grid.Styles>
                <Style Selector="Grid > :is(Control)">
                  <Setter Property="Margin" Value="0,0,8,0" />
                </Style>
              </Grid.Styles>
              
              <StackPanel Grid.Column="0" Spacing="8">
                <TextBlock Text="Количество частей" FontSize="14" FontWeight="SemiBold" Foreground="#424242" />
                <NumericUpDown Minimum="2" Maximum="100" Value="{Binding NumberOfParts}" HorizontalAlignment="Stretch" />
              </StackPanel>

              <StackPanel Grid.Column="1" Spacing="8" Margin="8,0,0,0">
                <TextBlock Text="Кодек видео" FontSize="14" FontWeight="SemiBold" Foreground="#424242" />
                <ComboBox SelectedIndex="{Binding CodecModeIndex}" HorizontalAlignment="Stretch">
                  <ComboBoxItem Content="Исходный (быстро, без потерь)" />
                  <ComboBoxItem Content="Сжатый для соцсетей (H.264)" />
                </ComboBox>
              </StackPanel>
            </Grid>

            <!-- Кнопки действий -->
            <Grid ColumnDefinitions="*,*,*,*" Margin="0,8,0,0">
              <Grid.Styles>
                <Style Selector="Grid > Button">
                  <Setter Property="Margin" Value="0,0,6,0" />
                  <Setter Property="Padding" Value="0,12" />
                  <Setter Property="FontWeight" Value="SemiBold" />
                  <Setter Property="HorizontalAlignment" Value="Stretch" />
                  <Setter Property="HorizontalContentAlignment" Value="Center" />
                  <Setter Property="CornerRadius" Value="6" />
                </Style>
              </Grid.Styles>
              
              <Button Grid.Column="0" Content="Загрузить метаданные" 
                      Command="{Binding LoadMetadataCommand}"
                      Background="#4CAF50"
                      Foreground="White" />
              <Button Grid.Column="1" Content="Предпросмотр" 
                      Command="{Binding PreviewCommand}"
                      Background="#FF9800"
                      Foreground="White" />
              <Button Grid.Column="2" Content="Разделить" 
                      Command="{Binding SplitCommand}"
                      Background="#2196F3"
                      Foreground="White" />
              <Button Grid.Column="3" Content="Отмена" 
                      Command="{Binding CancelCommand}"
                      Background="#F44336"
                      Foreground="White"
                      Margin="0" />
            </Grid>

            <!-- Прогресс -->
            <StackPanel Spacing="8">
              <ProgressBar Minimum="0" Maximum="100" Value="{Binding Progress}" Height="8" CornerRadius="4" />
              <TextBlock Text="{Binding Status}" TextWrapping="Wrap" FontSize="13" Foreground="#616161" />
            </StackPanel>
          </StackPanel>
        </Border>

        <!-- Предпросмотр -->
        <Border Grid.Row="2" Background="White" CornerRadius="12" BoxShadow="0 2 8 0 #20000000" Padding="24" Margin="0,0,0,0">
          <Grid RowDefinitions="Auto,*">
            <TextBlock Grid.Row="0" FontSize="18" FontWeight="SemiBold" Foreground="#424242" Text="Предпросмотр сегментов" Margin="0,0,0,16" />
            <DataGrid Grid.Row="1" ItemsSource="{Binding PreviewSegments}" 
                      AutoGenerateColumns="False" 
                      IsReadOnly="True"
                      GridLinesVisibility="None"
                      Background="Transparent"
                      CanUserResizeColumns="True">
              <DataGrid.Columns>
                <DataGridTextColumn Header="№" Binding="{Binding SegmentNumber}" Width="80" />
                <DataGridTextColumn Header="Начало" Binding="{Binding Start}" Width="*" />
                <DataGridTextColumn Header="Конец" Binding="{Binding End}" Width="*" />
                <DataGridTextColumn Header="Имя файла" Binding="{Binding OutputFileName}" Width="2*" />
              </DataGrid.Columns>
            </DataGrid>
          </Grid>
        </Border>
      </Grid>
    </TabItem>

    <!-- Вкладка О программе -->
    <TabItem>
      <TabItem.Header>
        <TextBlock Text="О программе" FontSize="14" FontWeight="SemiBold" />
      </TabItem.Header>
      
      <ScrollViewer>
        <Border Background="White" CornerRadius="12" BoxShadow="0 2 8 0 #20000000" Margin="24" Padding="32">
          <StackPanel Spacing="20" MaxWidth="800">
            <StackPanel Spacing="8">
              <TextBlock FontSize="32" FontWeight="Bold" Foreground="#1976D2" Text="Видеоредактор" />
              <TextBlock FontSize="16" Foreground="#757575" Text="Кросс-платформенное приложение для разделения видео" />
            </StackPanel>

            <Border Height="2" Background="#E0E0E0" CornerRadius="1" />

            <StackPanel Spacing="8">
              <TextBlock FontSize="20" FontWeight="SemiBold" Foreground="#424242" Text="Автор" />
              <TextBlock FontSize="16" Foreground="#616161" Text="Закир Алекперов" />
            </StackPanel>

            <Border Height="2" Background="#E0E0E0" CornerRadius="1" />

            <StackPanel Spacing="12">
              <TextBlock FontSize="20" FontWeight="SemiBold" Foreground="#424242" Text="Архитектура приложения" />
              <TextBlock TextWrapping="Wrap" FontSize="14" Foreground="#616161" Text="Приложение построено на основе Clean Architecture с явным разделением ответственности между слоями:" />

              <StackPanel Spacing="16" Margin="16,8,0,0">
                <Border Background="#E3F2FD" CornerRadius="8" Padding="16">
                  <StackPanel Spacing="6">
                    <TextBlock FontWeight="SemiBold" FontSize="15" Foreground="#1976D2" Text="Domain Layer (Ядро)" />
                    <TextBlock TextWrapping="Wrap" FontSize="13" Foreground="#424242" Text="Содержит доменные модели, бизнес-правила и инварианты. Не зависит от внешних библиотек." />
                  </StackPanel>
                </Border>

                <Border Background="#F3E5F5" CornerRadius="8" Padding="16">
                  <StackPanel Spacing="6">
                    <TextBlock FontWeight="SemiBold" FontSize="15" Foreground="#7B1FA2" Text="Application Layer (Сценарии)" />
                    <TextBlock TextWrapping="Wrap" FontSize="13" Foreground="#424242" Text="Оркестрирует use cases, содержит DTOs и валидацию. Зависит только от Domain." />
                  </StackPanel>
                </Border>

                <Border Background="#E8F5E9" CornerRadius="8" Padding="16">
                  <StackPanel Spacing="6">
                    <TextBlock FontWeight="SemiBold" FontSize="15" Foreground="#388E3C" Text="Infrastructure Layer (Инфраструктура)" />
                    <TextBlock TextWrapping="Wrap" FontSize="13" Foreground="#424242" Text="Реализует адаптеры для FFmpeg и файловой системы. Изолирует внешние зависимости." />
                  </StackPanel>
                </Border>

                <Border Background="#FFF3E0" CornerRadius="8" Padding="16">
                  <StackPanel Spacing="6">
                    <TextBlock FontWeight="SemiBold" FontSize="15" Foreground="#F57C00" Text="Presentation Layer (UI)" />
                    <TextBlock TextWrapping="Wrap" FontSize="13" Foreground="#424242" Text="Avalonia UI с MVVM. Обеспечивает кросс-платформенность (Windows, macOS, Linux)." />
                  </StackPanel>
                </Border>
              </StackPanel>
            </StackPanel>

            <Border Height="2" Background="#E0E0E0" CornerRadius="1" />

            <StackPanel Spacing="12">
              <TextBlock FontSize="20" FontWeight="SemiBold" Foreground="#424242" Text="Технологии" />
              <StackPanel Spacing="6" Margin="16,0,0,0">
                <TextBlock FontSize="14" Foreground="#616161" Text="• .NET 10" />
                <TextBlock FontSize="14" Foreground="#616161" Text="• Avalonia UI 11.1.0" />
                <TextBlock FontSize="14" Foreground="#616161" Text="• FFMpegCore 5.1.0" />
                <TextBlock FontSize="14" Foreground="#616161" Text="• Dependency Injection" />
              </StackPanel>
            </StackPanel>

            <Border Height="2" Background="#E0E0E0" CornerRadius="1" />

            <TextBlock FontSize="13" Foreground="#9E9E9E" TextWrapping="Wrap" Text="Для работы требуется FFmpeg в системе (PATH)." />
          </StackPanel>
        </Border>
      </ScrollViewer>
    </TabItem>
  </TabControl>

</Window>
